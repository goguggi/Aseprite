<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aseprite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px 20px;
            color: white;
            text-align: center;
        }

        .main-container {
            display: flex;
            flex: 1;
            padding: 20px;
            gap: 20px;
        }

        .left-panel {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow-y: auto;
            max-height: calc(100vh - 120px);
        }

        .canvas-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .right-panel {
            width: 320px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow-y: auto;
            max-height: calc(100vh - 120px);
        }

        .section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .tool-btn {
            padding: 12px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: #666;
        }

        .tool-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }

        .tool-btn.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .tool-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .canvas-wrapper {
            position: relative;
            border: 3px solid #333;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            background: #fff;
        }

        #pixelCanvas {
            display: block;
            cursor: crosshair;
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-crisp-edges;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        .color-palette {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 4px;
            margin-bottom: 10px;
        }

        .color-swatch {
            width: 28px;
            height: 28px;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-swatch:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .color-swatch.active {
            border-color: #333;
            transform: scale(1.15);
            box-shadow: 0 0 0 2px #667eea;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .animation-controls {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }

        .frame-list {
            max-height: 200px;
            overflow-y: auto;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background: #f8f9fa;
        }

        .frame-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 4px;
            background: white;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .frame-item:hover {
            background: #f0f0f0;
        }

        .frame-item.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .frame-preview {
            width: 40px;
            height: 40px;
            border: 1px solid #ccc;
            border-radius: 4px;
            image-rendering: pixelated;
        }

        .animation-preview {
            text-align: center;
            margin-bottom: 15px;
        }

        .canvas-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .zoom-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .brush-size-slider {
            margin-bottom: 15px;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .grid-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background: #ddd;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .toggle-switch.active {
            background: #667eea;
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(20px);
        }

        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
            }

            .left-panel, .right-panel {
                width: 100%;
                max-height: none;
            }

            .tool-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¨ í”½ì…€ì•„íŠ¸ ì—ë””í„° - í”„ë¡œí˜ì…”ë„</h1>
        <p>ì• ë‹ˆë©”ì´ì…˜ ì§€ì› Â· ê³ ê¸‰ ë„êµ¬ Â· JPG ë‚´ë³´ë‚´ê¸°</p>
    </div>

    <div class="main-container">
        <!-- ì™¼ìª½ íŒ¨ë„: ë„êµ¬ ë° ì„¤ì • -->
        <div class="left-panel">
            <!-- ë„êµ¬ ì„ íƒ -->
            <div class="section">
                <h3>ğŸ› ï¸ ë„êµ¬</h3>
                <div class="tool-grid">
                    <div class="tool-btn active" data-tool="pencil">
                        <div class="tool-icon">âœï¸</div>
                        <span>íœìŠ¬</span>
                    </div>
                    <div class="tool-btn" data-tool="brush">
                        <div class="tool-icon">ğŸ–Œï¸</div>
                        <span>ë¸ŒëŸ¬ì‹œ</span>
                    </div>
                    <div class="tool-btn" data-tool="eraser">
                        <div class="tool-icon">ğŸ§¹</div>
                        <span>ì§€ìš°ê°œ</span>
                    </div>
                    <div class="tool-btn" data-tool="bucket">
                        <div class="tool-icon">ğŸª£</div>
                        <span>ì±„ìš°ê¸°</span>
                    </div>
                    <div class="tool-btn" data-tool="eyedropper">
                        <div class="tool-icon">ğŸ’§</div>
                        <span>ìŠ¤í¬ì´ë“œ</span>
                    </div>
                    <div class="tool-btn" data-tool="line">
                        <div class="tool-icon">ğŸ“</div>
                        <span>ì§ì„ </span>
                    </div>
                    <div class="tool-btn" data-tool="rectangle">
                        <div class="tool-icon">â¬œ</div>
                        <span>ì‚¬ê°í˜•</span>
                    </div>
                    <div class="tool-btn" data-tool="circle">
                        <div class="tool-icon">â­•</div>
                        <span>ì›í˜•</span>
                    </div>
                    <div class="tool-btn" data-tool="select">
                        <div class="tool-icon">ğŸ”²</div>
                        <span>ì„ íƒ</span>
                    </div>
                </div>
            </div>

            <!-- ë¸ŒëŸ¬ì‹œ ì„¤ì • -->
            <div class="section">
                <h3>ğŸ–Œï¸ ë¸ŒëŸ¬ì‹œ ì„¤ì •</h3>
                <div class="brush-size-slider">
                    <label>ë¸ŒëŸ¬ì‹œ í¬ê¸°: <span id="brushSizeValue">1</span>px</label>
                    <input type="range" id="brushSize" class="slider" min="1" max="20" value="1">
                </div>
            </div>

            <!-- ìº”ë²„ìŠ¤ ì„¤ì • -->
            <div class="section">
                <h3>ğŸ“ ìº”ë²„ìŠ¤ ì„¤ì •</h3>
                <div class="input-group">
                    <label>ê°€ë¡œ í¬ê¸° (í”½ì…€)</label>
                    <input type="number" id="canvasWidth" value="32" min="8" max="512">
                </div>
                <div class="input-group">
                    <label>ì„¸ë¡œ í¬ê¸° (í”½ì…€)</label>
                    <input type="number" id="canvasHeight" value="32" min="8" max="512">
                </div>
                <button class="btn btn-secondary" onclick="resizeCanvas()">ìº”ë²„ìŠ¤ í¬ê¸° ë³€ê²½</button>
            </div>

            <!-- ê²©ì í‘œì‹œ -->
            <div class="section">
                <h3>ğŸ”³ í‘œì‹œ ì˜µì…˜</h3>
                <div class="grid-toggle">
                    <span>ê²©ì í‘œì‹œ</span>
                    <div class="toggle-switch active" id="gridToggle" onclick="toggleGrid()">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
            </div>

            <!-- íŒŒì¼ ì‘ì—… -->
            <div class="section">
                <h3>ğŸ’¾ íŒŒì¼</h3>
                <button class="btn btn-primary" onclick="downloadJPG()">JPGë¡œ ë‹¤ìš´ë¡œë“œ</button>
                <button class="btn btn-secondary" onclick="downloadPNG()">PNGë¡œ ë‹¤ìš´ë¡œë“œ</button>
                <button class="btn btn-secondary" onclick="downloadGIF()" id="downloadGifBtn">GIFë¡œ ë‹¤ìš´ë¡œë“œ</button>
                <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="loadImage()">
                <button class="btn btn-secondary" onclick="document.getElementById('fileInput').click()">ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <button class="btn btn-danger" onclick="clearCanvas()">ì „ì²´ ì§€ìš°ê¸°</button>
            </div>
        </div>

        <!-- ì¤‘ì•™: ìº”ë²„ìŠ¤ -->
        <div class="canvas-container">
            <div class="canvas-info">
                <span>í¬ê¸°: <span id="canvasSizeInfo">32 Ã— 32</span></span>
                <span>ì¤Œ: <span id="zoomLevel">400%</span></span>
            </div>
            
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">-</button>
                <span>ì¤Œ</span>
                <button class="zoom-btn" onclick="zoomIn()">+</button>
                <button class="btn btn-secondary" onclick="resetZoom()">ë¦¬ì…‹</button>
            </div>

            <div class="canvas-wrapper">
                <canvas id="pixelCanvas" width="32" height="32"></canvas>
            </div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ íŒ¨ë„: ìƒ‰ìƒ ë° ì• ë‹ˆë©”ì´ì…˜ -->
        <div class="right-panel">
            <!-- ìƒ‰ìƒ ì„ íƒ -->
            <div class="section">
                <h3>ğŸ¨ ìƒ‰ìƒ</h3>
                <div class="input-group">
                    <label>í˜„ì¬ ìƒ‰ìƒ</label>
                    <input type="color" id="colorPicker" value="#000000">
                </div>
                <div class="color-palette" id="colorPalette">
                    <!-- ìƒ‰ìƒ íŒ”ë ˆíŠ¸ê°€ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì• ë‹ˆë©”ì´ì…˜ -->
            <div class="section">
                <h3>ğŸ¬ ì• ë‹ˆë©”ì´ì…˜</h3>
                <div class="animation-controls">
                    <button class="btn btn-primary" onclick="addFrame()">í”„ë ˆì„ ì¶”ê°€</button>
                    <button class="btn btn-secondary" onclick="duplicateFrame()">ë³µì œ</button>
                    <button class="btn btn-danger" onclick="deleteFrame()">ì‚­ì œ</button>
                </div>
                
                <div class="input-group">
                    <label>í”„ë ˆì„ ì†ë„ (ms)</label>
                    <input type="number" id="frameDelay" value="500" min="50" max="5000">
                </div>

                <div class="animation-controls">
                    <button class="btn btn-primary" id="playBtn" onclick="toggleAnimation()">â–¶ï¸ ì¬ìƒ</button>
                    <button class="btn btn-secondary" onclick="stopAnimation()">â¹ï¸ ì •ì§€</button>
                </div>

                <div class="animation-preview">
                    <canvas id="animationPreview" width="80" height="80" style="border: 2px solid #ddd; border-radius: 8px; image-rendering: pixelated;"></canvas>
                </div>

                <div class="frame-list" id="frameList">
                    <!-- í”„ë ˆì„ ëª©ë¡ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ë ˆì´ì–´ -->
            <div class="section">
                <h3>ğŸ“š íˆìŠ¤í† ë¦¬</h3>
                <button class="btn btn-secondary" onclick="undo()" id="undoBtn">â†¶ ì‹¤í–‰ì·¨ì†Œ</button>
                <button class="btn btn-secondary" onclick="redo()" id="redoBtn">â†· ë‹¤ì‹œì‹¤í–‰</button>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜ë“¤
        let canvas, ctx, animationPreview, animationCtx;
        let currentTool = 'pencil';
        let currentColor = '#000000';
        let brushSize = 1;
        let isDrawing = false;
        let showGrid = true;
        let zoom = 400;
        let lastX, lastY;
        let startX, startY;
        let history = [];
        let historyStep = -1;
        let frames = [];
        let currentFrame = 0;
        let animationPlaying = false;
        let animationInterval;

        // ì´ˆê¸°í™”
        window.onload = function() {
            canvas = document.getElementById('pixelCanvas');
            ctx = canvas.getContext('2d');
            animationPreview = document.getElementById('animationPreview');
            animationCtx = animationPreview.getContext('2d');
            
            // í”½ì…€ ì™„ë²½ ë Œë”ë§ ì„¤ì •
            ctx.imageSmoothingEnabled = false;
            animationCtx.imageSmoothingEnabled = false;
            
            initializeColorPalette();
            setupEventListeners();
            updateCanvasSize();
            saveState();
            
            // ì²« ë²ˆì§¸ í”„ë ˆì„ ìƒì„±
            addFrame();
        };

        // ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì´ˆê¸°í™”
        function initializeColorPalette() {
            const palette = document.getElementById('colorPalette');
            const colors = [
                '#000000', '#FFFFFF', '#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF',
                '#800000', '#808080', '#800080', '#008000', '#000080', '#808000', '#C0C0C0', '#FF8000',
                '#8B4513', '#FFC0CB', '#FFE4B5', '#98FB98', '#87CEEB', '#DDA0DD', '#F0E68C', '#FA8072',
                '#FF6347', '#40E0D0', '#EE82EE', '#90EE90', '#F0F8FF', '#FFEFD5', '#D2691E', '#CD853F'
            ];

            colors.forEach(color => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color;
                swatch.onclick = () => selectColor(color);
                palette.appendChild(swatch);
            });

            // ì²« ë²ˆì§¸ ìƒ‰ìƒ ì„ íƒ
            selectColor(colors[0]);
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            // ë„êµ¬ ì„ íƒ
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.addEventListener('click', () => selectTool(btn.dataset.tool));
            });

            // ìƒ‰ìƒ ì„ íƒê¸°
            document.getElementById('colorPicker').addEventListener('change', (e) => {
                selectColor(e.target.value);
            });

            // ë¸ŒëŸ¬ì‹œ í¬ê¸°
            document.getElementById('brushSize').addEventListener('input', (e) => {
                brushSize = parseInt(e.target.value);
                document.getElementById('brushSizeValue').textContent = brushSize;
            });

            // ìº”ë²„ìŠ¤ ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseleave', stopDrawing);

            // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
            document.addEventListener('keydown', handleKeyPress);
        }

        // ë„êµ¬ ì„ íƒ
        function selectTool(tool) {
            currentTool = tool;
            document.querySelectorAll('.tool-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-tool="${tool}"]`).classList.add('active');
            
            // ì»¤ì„œ ë³€ê²½
            switch(tool) {
                case 'eyedropper': canvas.style.cursor = 'crosshair'; break;
                case 'bucket': canvas.style.cursor = 'crosshair'; break;
                case 'eraser': canvas.style.cursor = 'crosshair'; break;
                default: canvas.style.cursor = 'crosshair';
            }
        }

        // ìƒ‰ìƒ ì„ íƒ
        function selectColor(color) {
            currentColor = color;
            document.getElementById('colorPicker').value = color;
            document.querySelectorAll('.color-swatch').forEach(swatch => swatch.classList.remove('active'));
            document.querySelectorAll('.color-swatch').forEach(swatch => {
                if (swatch.style.backgroundColor === color || rgbToHex(swatch.style.backgroundColor) === color) {
                    swatch.classList.add('active');
                }
            });
        }

        // RGBë¥¼ HEXë¡œ ë³€í™˜
        function rgbToHex(rgb) {
            if (rgb.startsWith('#')) return rgb;
            const result = rgb.match(/\d+/g);
            return '#' + ((1 << 24) + (parseInt(result[0]) << 16) + (parseInt(result[1]) << 8) + parseInt(result[2])).toString(16).slice(1);
        }

        // ê·¸ë¦¬ê¸° ì‹œì‘
        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            lastX = Math.floor((e.clientX - rect.left) * scaleX);
            lastY = Math.floor((e.clientY - rect.top) * scaleY);
            startX = lastX;
            startY = lastY;

            handleTool(lastX, lastY, e);
        }

        // ê·¸ë¦¬ê¸°
        function draw(e) {
            if (!isDrawing && currentTool !== 'eyedropper') return;
            
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            const currentX = Math.floor((e.clientX - rect.left) * scaleX);
            const currentY = Math.floor((e.clientY - rect.top) * scaleY);

            if (currentTool === 'eyedropper') {
                showColorPreview(currentX, currentY);
                return;
            }

            handleTool(currentX, currentY, e);
            
            lastX = currentX;
            lastY = currentY;
        }

        // ê·¸ë¦¬ê¸° ì¢…ë£Œ
        function stopDrawing(e) {
            if (!isDrawing) return;
            isDrawing = false;
            
            if (['line', 'rectangle', 'circle'].includes(currentTool)) {
                const rect = canvas.getBoundingClientRect();
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                
                const endX = Math.floor((e.clientX - rect.left) * scaleX);
                const endY = Math.floor((e.clientY - rect.top) * scaleY);
                
                drawShape(startX, startY, endX, endY);
            }
            
            saveState();
            updateCurrentFrame();
        }

        // ë„êµ¬ë³„ ì²˜ë¦¬
        function handleTool(x, y, e) {
            switch(currentTool) {
                case 'pencil':
                    drawPixel(x, y);
                    break;
                case 'brush':
                    drawBrush(x, y);
                    break;
                case 'eraser':
                    erasePixel(x, y);
                    break;
                case 'bucket':
                    if (isDrawing) floodFill(x, y);
                    break;
                case 'eyedropper':
                    pickColor(x, y);
                    break;
                case 'line':
                case 'rectangle':
                case 'circle':
                    // ë¯¸ë¦¬ë³´ê¸°ëŠ” ì—¬ê¸°ì„œ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ (ì‹¤ì œ ê·¸ë¦¬ê¸°ëŠ” stopDrawingì—ì„œ)
                    break;
                case 'select':
                    // ì„ íƒ ë„êµ¬ ë¡œì§
                    break;
            }
            
            if (showGrid) drawGrid();
            updateAnimationPreview();
        }

        // í”½ì…€ ê·¸ë¦¬ê¸°
        function drawPixel(x, y) {
            if (x >= 0 && x < canvas.width && y >= 0 && y < canvas.height) {
                ctx.fillStyle = currentColor;
                ctx.fillRect(x, y, 1, 1);
            }
        }

        // ë¸ŒëŸ¬ì‹œ ê·¸ë¦¬ê¸°
        function drawBrush(x, y) {
            const halfSize = Math.floor(brushSize / 2);
            for (let i = -halfSize; i <= halfSize; i++) {
                for (let j = -halfSize; j <= halfSize; j++) {
                    const distance = Math.sqrt(i * i + j * j);
                    if (distance <= halfSize) {
                        drawPixel(x + i, y + j);
                    }
                }
            }
        }

        // ì§€ìš°ê°œ
        function erasePixel(x, y) {
            const halfSize = Math.floor(brushSize / 2);
            for (let i = -halfSize; i <= halfSize; i++) {
                for (let j = -halfSize; j <= halfSize; j++) {
                    const distance = Math.sqrt(i * i + j * j);
                    if (distance <= halfSize && x + i >= 0 && x + i < canvas.width && y + j >= 0 && y + j < canvas.height) {
                        ctx.clearRect(x + i, y + j, 1, 1);
                    }
                }
            }
        }

        // ìƒ‰ìƒ ì¶”ì¶œ
        function pickColor(x, y) {
            if (x >= 0 && x < canvas.width && y >= 0 && y < canvas.height) {
                const imageData = ctx.getImageData(x, y, 1, 1);
                const data = imageData.data;
                if (data[3] > 0) { // íˆ¬ëª…í•˜ì§€ ì•Šì€ ê²½ìš°ë§Œ
                    const color = '#' + ((1 << 24) + (data[0] << 16) + (data[1] << 8) + data[2]).toString(16).slice(1);
                    selectColor(color);
                }
            }
        }

        // ìƒ‰ìƒ ë¯¸ë¦¬ë³´ê¸° (ìŠ¤í¬ì´ë“œ ë„êµ¬ìš©)
        function showColorPreview(x, y) {
            if (x >= 0 && x < canvas.width && y >= 0 && y < canvas.height) {
                const imageData = ctx.getImageData(x, y, 1, 1);
                const data = imageData.data;
                if (data[3] > 0) {
                    const color = '#' + ((1 << 24) + (data[0] << 16) + (data[1] << 8) + data[2]).toString(16).slice(1);
                    document.getElementById('colorPicker').value = color;
                }
            }
        }

        // ì±„ìš°ê¸° (í”ŒëŸ¬ë“œ í•„)
        function floodFill(startX, startY) {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            const targetColor = getPixelColor(imageData, startX, startY);
            const fillColor = hexToRgb(currentColor);
            
            if (colorsEqual(targetColor, fillColor)) return;
            
            const stack = [[startX, startY]];
            const visited = new Set();
            
            while (stack.length > 0) {
                const [x, y] = stack.pop();
                const key = x + ',' + y;
                
                if (visited.has(key) || x < 0 || x >= canvas.width || y < 0 || y >= canvas.height) {
                    continue;
                }
                
                const currentColor = getPixelColor(imageData, x, y);
                if (!colorsEqual(currentColor, targetColor)) {
                    continue;
                }
                
                visited.add(key);
                setPixelColor(imageData, x, y, fillColor);
                
                stack.push([x + 1, y], [x - 1, y], [x, y + 1], [x, y - 1]);
            }
            
            ctx.putImageData(imageData, 0, 0);
        }

        // í”½ì…€ ìƒ‰ìƒ ê°€ì ¸ì˜¤ê¸°
        function getPixelColor(imageData, x, y) {
            const index = (y * imageData.width + x) * 4;
            return {
                r: imageData.data[index],
                g: imageData.data[index + 1],
                b: imageData.data[index + 2],
                a: imageData.data[index + 3]
            };
        }

        // í”½ì…€ ìƒ‰ìƒ ì„¤ì •
        function setPixelColor(imageData, x, y, color) {
            const index = (y * imageData.width + x) * 4;
            imageData.data[index] = color.r;
            imageData.data[index + 1] = color.g;
            imageData.data[index + 2] = color.b;
            imageData.data[index + 3] = 255;
        }

        // ìƒ‰ìƒ ë¹„êµ
        function colorsEqual(color1, color2) {
            return color1.r === color2.r && color1.g === color2.g && color1.b === color2.b && color1.a === color2.a;
        }

        // HEXë¥¼ RGBë¡œ ë³€í™˜
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16),
                a: 255
            } : null;
        }

        // ë„í˜• ê·¸ë¦¬ê¸°
        function drawShape(startX, startY, endX, endY) {
            ctx.fillStyle = currentColor;
            
            switch(currentTool) {
                case 'line':
                    drawLine(startX, startY, endX, endY);
                    break;
                case 'rectangle':
                    drawRectangle(startX, startY, endX, endY);
                    break;
                case 'circle':
                    drawCircle(startX, startY, endX, endY);
                    break;
            }
        }

        // ì§ì„  ê·¸ë¦¬ê¸° (ë¸Œë ˆì  í–„ ì•Œê³ ë¦¬ì¦˜)
        function drawLine(x0, y0, x1, y1) {
            const dx = Math.abs(x1 - x0);
            const dy = Math.abs(y1 - y0);
            const sx = x0 < x1 ? 1 : -1;
            const sy = y0 < y1 ? 1 : -1;
            let err = dx - dy;

            while (true) {
                drawPixel(x0, y0);
                
                if (x0 === x1 && y0 === y1) break;
                
                const e2 = 2 * err;
                if (e2 > -dy) {
                    err -= dy;
                    x0 += sx;
                }
                if (e2 < dx) {
                    err += dx;
                    y0 += sy;
                }
            }
        }

        // ì‚¬ê°í˜• ê·¸ë¦¬ê¸°
        function drawRectangle(startX, startY, endX, endY) {
            const minX = Math.min(startX, endX);
            const maxX = Math.max(startX, endX);
            const minY = Math.min(startY, endY);
            const maxY = Math.max(startY, endY);
            
            // í…Œë‘ë¦¬ë§Œ ê·¸ë¦¬ê¸°
            for (let x = minX; x <= maxX; x++) {
                drawPixel(x, minY);
                drawPixel(x, maxY);
            }
            for (let y = minY; y <= maxY; y++) {
                drawPixel(minX, y);
                drawPixel(maxX, y);
            }
        }

        // ì› ê·¸ë¦¬ê¸° (ë¯¸ë“œí¬ì¸íŠ¸ ì› ì•Œê³ ë¦¬ì¦˜)
        function drawCircle(centerX, centerY, endX, endY) {
            const radius = Math.round(Math.sqrt((endX - centerX) ** 2 + (endY - centerY) ** 2));
            let x = radius;
            let y = 0;
            let err = 0;

            while (x >= y) {
                drawPixel(centerX + x, centerY + y);
                drawPixel(centerX + y, centerY + x);
                drawPixel(centerX - y, centerY + x);
                drawPixel(centerX - x, centerY + y);
                drawPixel(centerX - x, centerY - y);
                drawPixel(centerX - y, centerY - x);
                drawPixel(centerX + y, centerY - x);
                drawPixel(centerX + x, centerY - y);

                if (err <= 0) {
                    y += 1;
                    err += 2 * y + 1;
                }
                if (err > 0) {
                    x -= 1;
                    err -= 2 * x + 1;
                }
            }
        }

        // ê²©ì ê·¸ë¦¬ê¸°
        function drawGrid() {
            const displayCanvas = canvas;
            const displayRect = displayCanvas.getBoundingClientRect();
            const scale = displayRect.width / canvas.width;
            
            if (scale < 4) return; // ë„ˆë¬´ ì‘ìœ¼ë©´ ê²©ì í‘œì‹œ ì•ˆ í•¨
            
            // ê²©ìëŠ” CSSë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì 
        }

        // ê²©ì í† ê¸€
        function toggleGrid() {
            showGrid = !showGrid;
            const toggle = document.getElementById('gridToggle');
            toggle.classList.toggle('active');
            
            if (showGrid) {
                canvas.style.backgroundImage = 'linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px)';
                canvas.style.backgroundSize = `${zoom/100 * 4}px ${zoom/100 * 4}px`;
            } else {
                canvas.style.backgroundImage = 'none';
            }
        }

        // ìº”ë²„ìŠ¤ í¬ê¸° ì—…ë°ì´íŠ¸
        function updateCanvasSize() {
            const pixelSize = Math.max(1, Math.floor(zoom / 100 * 4));
            canvas.style.width = (canvas.width * pixelSize) + 'px';
            canvas.style.height = (canvas.height * pixelSize) + 'px';
            
            document.getElementById('canvasSizeInfo').textContent = `${canvas.width} Ã— ${canvas.height}`;
            document.getElementById('zoomLevel').textContent = `${zoom}%`;
            
            if (showGrid) {
                canvas.style.backgroundSize = `${pixelSize}px ${pixelSize}px`;
            }
        }

        // ì¤Œ ì¸
        function zoomIn() {
            if (zoom < 2000) {
                zoom += 100;
                updateCanvasSize();
            }
        }

        // ì¤Œ ì•„ì›ƒ
        function zoomOut() {
            if (zoom > 100) {
                zoom -= 100;
                updateCanvasSize();
            }
        }

        // ì¤Œ ë¦¬ì…‹
        function resetZoom() {
            zoom = 400;
            updateCanvasSize();
        }

        // ìº”ë²„ìŠ¤ í¬ê¸° ë³€ê²½
        function resizeCanvas() {
            const width = parseInt(document.getElementById('canvasWidth').value);
            const height = parseInt(document.getElementById('canvasHeight').value);
            
            if (width < 8 || width > 512 || height < 8 || height > 512) {
                alert('ìº”ë²„ìŠ¤ í¬ê¸°ëŠ” 8~512 í”½ì…€ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            // í˜„ì¬ ìº”ë²„ìŠ¤ ë°ì´í„° ë°±ì—…
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            
            // ìº”ë²„ìŠ¤ í¬ê¸° ë³€ê²½
            canvas.width = width;
            canvas.height = height;
            
            // ê°€ëŠ¥í•œ ê²½ìš° ê¸°ì¡´ ë°ì´í„° ë³µì›
            const minWidth = Math.min(width, imageData.width);
            const minHeight = Math.min(height, imageData.height);
            const newImageData = ctx.createImageData(minWidth, minHeight);
            
            for (let y = 0; y < minHeight; y++) {
                for (let x = 0; x < minWidth; x++) {
                    const oldIndex = (y * imageData.width + x) * 4;
                    const newIndex = (y * minWidth + x) * 4;
                    newImageData.data[newIndex] = imageData.data[oldIndex];
                    newImageData.data[newIndex + 1] = imageData.data[oldIndex + 1];
                    newImageData.data[newIndex + 2] = imageData.data[oldIndex + 2];
                    newImageData.data[newIndex + 3] = imageData.data[oldIndex + 3];
                }
            }
            
            ctx.putImageData(newImageData, 0, 0);
            updateCanvasSize();
            saveState();
            updateCurrentFrame();
        }

        // ì „ì²´ ì§€ìš°ê¸°
        function clearCanvas() {
            if (confirm('ì „ì²´ ìº”ë²„ìŠ¤ë¥¼ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                saveState();
                updateCurrentFrame();
            }
        }

        // ìƒíƒœ ì €ì¥ (ì‹¤í–‰ì·¨ì†Œ/ë‹¤ì‹œì‹¤í–‰ìš©)
        function saveState() {
            historyStep++;
            if (historyStep < history.length) {
                history.length = historyStep;
            }
            history.push(canvas.toDataURL());
            if (history.length > 50) {
                history.shift();
                historyStep--;
            }
        }

        // ì‹¤í–‰ì·¨ì†Œ
        function undo() {
            if (historyStep > 0) {
                historyStep--;
                restoreState();
            }
        }

        // ë‹¤ì‹œì‹¤í–‰
        function redo() {
            if (historyStep < history.length - 1) {
                historyStep++;
                restoreState();
            }
        }

        // ìƒíƒœ ë³µì›
        function restoreState() {
            const img = new Image();
            img.onload = function() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
                updateCurrentFrame();
            };
            img.src = history[historyStep];
        }

        // í”„ë ˆì„ ì¶”ê°€
        function addFrame() {
            frames.push({
                data: canvas.toDataURL(),
                thumbnail: createThumbnail()
            });
            currentFrame = frames.length - 1;
            updateFrameList();
            updateAnimationPreview();
        }

        // í”„ë ˆì„ ë³µì œ
        function duplicateFrame() {
            if (frames.length === 0) {
                addFrame();
                return;
            }
            
            frames.splice(currentFrame + 1, 0, {
                data: frames[currentFrame].data,
                thumbnail: frames[currentFrame].thumbnail
            });
            currentFrame++;
            updateFrameList();
        }

        // í”„ë ˆì„ ì‚­ì œ
        function deleteFrame() {
            if (frames.length <= 1) {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ í”„ë ˆì„ì€ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            frames.splice(currentFrame, 1);
            if (currentFrame >= frames.length) {
                currentFrame = frames.length - 1;
            }
            loadFrame(currentFrame);
            updateFrameList();
        }

        // ì¸ë„¤ì¼ ìƒì„±
        function createThumbnail() {
            const thumbnailCanvas = document.createElement('canvas');
            thumbnailCanvas.width = 40;
            thumbnailCanvas.height = 40;
            const thumbnailCtx = thumbnailCanvas.getContext('2d');
            thumbnailCtx.imageSmoothingEnabled = false;
            thumbnailCtx.drawImage(canvas, 0, 0, 40, 40);
            return thumbnailCanvas.toDataURL();
        }

        // í”„ë ˆì„ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateFrameList() {
            const frameList = document.getElementById('frameList');
            frameList.innerHTML = '';
            
            frames.forEach((frame, index) => {
                const frameItem = document.createElement('div');
                frameItem.className = `frame-item ${index === currentFrame ? 'active' : ''}`;
                frameItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <img src="${frame.thumbnail}" class="frame-preview" alt="Frame ${index + 1}">
                        <span>í”„ë ˆì„ ${index + 1}</span>
                    </div>
                    <button onclick="deleteFrameAt(${index})" style="background: #ff6b6b; color: white; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer;">Ã—</button>
                `;
                frameItem.onclick = (e) => {
                    if (e.target.tagName !== 'BUTTON') {
                        selectFrame(index);
                    }
                };
                frameList.appendChild(frameItem);
            });
        }

        // íŠ¹ì • ì¸ë±ìŠ¤ì˜ í”„ë ˆì„ ì‚­ì œ
        function deleteFrameAt(index) {
            if (frames.length <= 1) {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ í”„ë ˆì„ì€ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            frames.splice(index, 1);
            if (currentFrame >= index && currentFrame > 0) {
                currentFrame--;
            }
            if (currentFrame >= frames.length) {
                currentFrame = frames.length - 1;
            }
            loadFrame(currentFrame);
            updateFrameList();
        }

        // í”„ë ˆì„ ì„ íƒ
        function selectFrame(index) {
            updateCurrentFrame(); // í˜„ì¬ í”„ë ˆì„ ì €ì¥
            currentFrame = index;
            loadFrame(index);
            updateFrameList();
        }

        // í”„ë ˆì„ ë¡œë“œ
        function loadFrame(index) {
            if (index < 0 || index >= frames.length) return;
            
            const img = new Image();
            img.onload = function() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
            };
            img.src = frames[index].data;
        }

        // í˜„ì¬ í”„ë ˆì„ ì—…ë°ì´íŠ¸
        function updateCurrentFrame() {
            if (frames.length > 0 && currentFrame < frames.length) {
                frames[currentFrame] = {
                    data: canvas.toDataURL(),
                    thumbnail: createThumbnail()
                };
                updateFrameList();
                updateAnimationPreview();
            }
        }

        // ì• ë‹ˆë©”ì´ì…˜ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updateAnimationPreview() {
            if (frames.length === 0) return;
            
            const img = new Image();
            img.onload = function() {
                animationCtx.clearRect(0, 0, 80, 80);
                animationCtx.drawImage(img, 0, 0, 80, 80);
            };
            img.src = frames[currentFrame]?.data || canvas.toDataURL();
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ/ì •ì§€ í† ê¸€
        function toggleAnimation() {
            if (animationPlaying) {
                stopAnimation();
            } else {
                playAnimation();
            }
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
        function playAnimation() {
            if (frames.length <= 1) {
                alert('ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒí•˜ë ¤ë©´ ìµœì†Œ 2ê°œì˜ í”„ë ˆì„ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            animationPlaying = true;
            document.getElementById('playBtn').innerHTML = 'â¸ï¸ ì¼ì‹œì •ì§€';
            
            let frameIndex = 0;
            const frameDelay = parseInt(document.getElementById('frameDelay').value);
            
            animationInterval = setInterval(() => {
                const img = new Image();
                img.onload = function() {
                    animationCtx.clearRect(0, 0, 80, 80);
                    animationCtx.drawImage(img, 0, 0, 80, 80);
                };
                img.src = frames[frameIndex].data;
                
                frameIndex = (frameIndex + 1) % frames.length;
            }, frameDelay);
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
        function stopAnimation() {
            animationPlaying = false;
            document.getElementById('playBtn').innerHTML = 'â–¶ï¸ ì¬ìƒ';
            
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
            }
            
            updateAnimationPreview();
        }

        // ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadImage() {
            const file = document.getElementById('fileInput').files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    saveState();
                    updateCurrentFrame();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // JPGë¡œ ë‹¤ìš´ë¡œë“œ
        function downloadJPG() {
            // ì• ë‹ˆë©”ì´ì…˜ì´ ìˆëŠ” ê²½ìš° í˜„ì¬ í”„ë ˆì„ë§Œ ë‹¤ìš´ë¡œë“œ
            const link = document.createElement('a');
            
            // JPG ë³€í™˜ì„ ìœ„í•´ í°ìƒ‰ ë°°ê²½ ì¶”ê°€
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = canvas.width;
            tempCanvas.height = canvas.height;
            const tempCtx = tempCanvas.getContext('2d');
            
            // í°ìƒ‰ ë°°ê²½
            tempCtx.fillStyle = '#FFFFFF';
            tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
            
            // í˜„ì¬ ìº”ë²„ìŠ¤ ë‚´ìš© ë³µì‚¬
            tempCtx.drawImage(canvas, 0, 0);
            
            link.download = `pixel_art_${Date.now()}.jpg`;
            link.href = tempCanvas.toDataURL('image/jpeg', 0.9);
            link.click();
        }

        // PNGë¡œ ë‹¤ìš´ë¡œë“œ
        function downloadPNG() {
            const link = document.createElement('a');
            link.download = `pixel_art_${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // GIFë¡œ ë‹¤ìš´ë¡œë“œ (ì• ë‹ˆë©”ì´ì…˜)
        function downloadGIF() {
            if (frames.length <= 1) {
                alert('GIF ì• ë‹ˆë©”ì´ì…˜ì„ ë§Œë“¤ë ¤ë©´ ìµœì†Œ 2ê°œì˜ í”„ë ˆì„ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            alert('GIF ìƒì„± ê¸°ëŠ¥ì€ ë¸Œë¼ìš°ì € í•œê³„ë¡œ ì¸í•´ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  ê° í”„ë ˆì„ì„ PNGë¡œ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì™¸ë¶€ ë„êµ¬ì—ì„œ GIFë¡œ ë³€í™˜í•´ì£¼ì„¸ìš”.');
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        function handleKeyPress(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'z':
                        e.preventDefault();
                        if (e.shiftKey) {
                            redo();
                        } else {
                            undo();
                        }
                        break;
                    case 'y':
                        e.preventDefault();
                        redo();
                        break;
                    case 's':
                        e.preventDefault();
                        downloadPNG();
                        break;
                }
            }
            
            // ë„êµ¬ ë‹¨ì¶•í‚¤
            switch(e.key) {
                case 'p': selectTool('pencil'); break;
                case 'b': selectTool('brush'); break;
                case 'e': selectTool('eraser'); break;
                case 'f': selectTool('bucket'); break;
                case 'i': selectTool('eyedropper'); break;
                case 'l': selectTool('line'); break;
                case 'r': selectTool('rectangle'); break;
                case 'c': selectTool('circle'); break;
                case 's': selectTool('select'); break;
            }
        }
    </script>
</body>
</html>